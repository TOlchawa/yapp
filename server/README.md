# Project Description

This project contains the code for the server-side (backend) of the application.

## Running Integration Tests

Integration tests with the suffix `IT` require the application to be running locally. Ensure that the application is
started before executing these tests.

To start the application locally, run:

```bash
mvn spring-boot:run
```

## Setting Up Redis with Spring Boot

To configure Redis in your Spring Boot application, add the following settings to your `application.yml` file:

```yaml
spring:
  redis:
    host: localhost
    port: 6379
    password:
    database: 0
```

Ensure that Redis is running locally on port `6379` before starting the application. You can start Redis using Docker
with:

```bash
docker run --name redis -d -p 6379:6379 redis
```

### MongoDB and Redis CLI

* Mongo

```bash
mongosh --password **** --username admin
```

* Redis

```bash
redis-cli --user default --pass ****
```

## Certificates Generate

```aiignore
openssl genpkey -algorithm RSA -out private.pem -pkeyopt rsa_keygen_bits:2048
openssl rsa -pubout -in private.pem -out public.pem
```

## Enabling CORS for Cross-Origin Requests

If you want to connect to the backend from a different host or port (for example, when running the frontend on
`http://localhost:5174`), you need to enable CORS in the application.

In this project, we use a dedicated Spring profile `DEV` to activate CORS settings. To enable CORS, start the
application with the `DEV` profile:

```bash
java -Dspring.profiles.active=DEV -jar memoritta.jar
```

Or, if you use Maven:

```bash
mvn spring-boot:run -Dspring-boot.run.profiles=DEV
```

When the `DEV` profile is active, the application will register CORS configuration that allows requests from your
frontend origin (`http://localhost:5174`). Make sure your `WebConfig` and `CorsFilterConfig` classes are annotated with
`@Profile("DEV")` so that CORS is only enabled in development.

Now, your frontend running on a different host or port can access the backend endpoints without CORS errors.


## OpenAI Configuration

The application can call OpenAI for text smoothing. Set the following properties in `application.yml` or as environment variables:

```yaml
openai:
  url: https://api.openai.com/v1/chat/completions
  api-key: YOUR_API_KEY
  organization: org-n9AnfI7a4lvpGr50hbypFLxB
  project: proj_5ODKT8ABkqMtUdXihb10kbIX
```

The `organization` and `project` values are optional. If provided, they are sent as `OpenAI-Organization` and `OpenAI-Project` headers.

### Answering questions

Send a POST request to `/ai/ask` with plain text. The service returns the answer generated by OpenAI.
